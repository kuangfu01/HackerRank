// https://www.hackerrank.com/challenges/huge-gcd-fp
open System
open System.IO
open System.Collections.Generic
 
let primes = [| 2; 3; 5; 7; 11; 13; 17; 19; 23; 29; 31; 37; 41; 43; 47; 53; 59; 61; 67; 71; 73;79; 83; 89; 97; 101; 103; 107; 109; 113; 127; 131; 137; 139; 149; 151; 157; 163; 167; 173; 179; 181; 191; 193; 197; 199; 211; 223; 227; 229; 233; 239; 241; 251; 257; 263; 269; 271; 277; 281; 283; 293; 307; 311; 313; 317; 331; 337; 347; 349; 353; 359; 367; 373; 379; 383; 389; 397; 401; 409; 419; 421; 431; 433; 439; 443; 449; 457; 461; 463; 467; 479; 487; 491; 499; 503; 509; 521; 523; 541; 547; 557; 563; 569; 571; 577; 587; 593; 599; 601; 607; 613; 617; 619; 631; 641; 643; 647; 653; 659; 661; 673; 677; 683; 691; 701; 709; 719; 727; 733; 739; 743; 751; 757; 761; 769; 773; 787; 797; 809; 811; 821; 823; 827; 829; 839; 853; 857; 859; 863; 877; 881; 883; 887; 907; 911; 919; 929; 937; 941; 947; 953; 967; 971; 977; 983; 991; 997; 1009; 1013; 1019; 1021; 1031; 1033; 1039; 1049; 1051; 1061; 1063; 1069; 1087; 1091; 1093; 1097; 1103; 1109; 1117; 1123; 1129; 1151; 1153; 1163; 1171; 1181; 1187; 1193; 1201; 1213; 1217; 1223; 1229; 1231; 1237; 1249; 1259; 1277; 1279; 1283; 1289; 1291; 1297; 1301; 1303; 1307; 1319; 1321; 1327; 1361; 1367; 1373; 1381; 1399; 1409; 1423; 1427; 1429; 1433; 1439; 1447; 1451; 1453; 1459; 1471; 1481; 1483; 1487; 1489; 1493; 1499; 1511; 1523; 1531; 1543; 1549; 1553; 1559; 1567; 1571; 1579; 1583; 1597; 1601; 1607; 1609; 1613; 1619; 1621; 1627; 1637; 1657; 1663; 1667; 1669; 1693; 1697; 1699; 1709; 1721; 1723; 1733; 1741; 1747; 1753; 1759; 1777; 1783; 1787; 1789; 1801; 1811; 1823; 1831; 1847; 1861; 1867; 1871; 1873; 1877; 1879; 1889; 1901; 1907; 1913; 1931; 1933; 1949; 1951; 1973; 1979; 1987; 1993; 1997; 1999; 2003; 2011; 2017; 2027; 2029; 2039; 2053; 2063; 2069; 2081; 2083; 2087; 2089; 2099; 2111; 2113; 2129; 2131; 2137; 2141; 2143; 2153; 2161; 2179; 2203; 2207; 2213; 2221; 2237; 2239; 2243; 2251; 2267; 2269; 2273; 2281; 2287; 2293; 2297; 2309; 2311; 2333; 2339; 2341; 2347; 2351; 2357; 2371; 2377; 2381; 2383; 2389; 2393; 2399; 2411; 2417; 2423; 2437; 2441; 2447; 2459; 2467; 2473; 2477; 2503; 2521; 2531; 2539; 2543; 2549; 2551; 2557; 2579; 2591; 2593; 2609; 2617; 2621; 2633; 2647; 2657; 2659; 2663; 2671; 2677; 2683; 2687; 2689; 2693; 2699; 2707; 2711; 2713; 2719; 2729; 2731; 2741; 2749; 2753; 2767; 2777; 2789; 2791; 2797; 2801; 2803; 2819; 2833; 2837; 2843; 2851; 2857; 2861; 2879; 2887; 2897; 2903; 2909; 2917; 2927; 2939; 2953; 2957; 2963; 2969; 2971; 2999; 3001; 3011; 3019; 3023; 3037; 3041; 3049; 3061; 3067; 3079; 3083; 3089; 3109; 3119; 3121; 3137; 3163; 3167; 3169; 3181; 3187; 3191; 3203; 3209; 3217; 3221; 3229; 3251; 3253; 3257; 3259; 3271; 3299; 3301; 3307; 3313; 3319; 3323; 3329; 3331; 3343; 3347; 3359; 3361; 3371; 3373; 3389; 3391; 3407; 3413; 3433; 3449; 3457; 3461; 3463; 3467; 3469; 3491; 3499; 3511; 3517; 3527; 3529; 3533; 3539; 3541; 3547; 3557; 3559; 3571; 3581; 3583; 3593; 3607; 3613; 3617; 3623; 3631; 3637; 3643; 3659; 3671; 3673; 3677; 3691; 3697; 3701; 3709; 3719; 3727; 3733; 3739; 3761; 3767; 3769; 3779; 3793; 3797; 3803; 3821; 3823; 3833; 3847; 3851; 3853; 3863; 3877; 3881; 3889; 3907; 3911; 3917; 3919; 3923; 3929; 3931; 3943; 3947; 3967; 3989; 4001; 4003; 4007; 4013; 4019; 4021; 4027; 4049; 4051; 4057; 4073; 4079; 4091; 4093; 4099; 4111; 4127; 4129; 4133; 4139; 4153; 4157; 4159; 4177; 4201; 4211; 4217; 4219; 4229; 4231; 4241; 4243; 4253; 4259; 4261; 4271; 4273; 4283; 4289; 4297; 4327; 4337; 4339; 4349; 4357; 4363; 4373; 4391; 4397; 4409; 4421; 4423; 4441; 4447; 4451; 4457; 4463; 4481; 4483; 4493; 4507; 4513; 4517; 4519; 4523; 4547; 4549; 4561; 4567; 4583; 4591; 4597; 4603; 4621; 4637; 4639; 4643; 4649; 4651; 4657; 4663; 4673; 4679; 4691; 4703; 4721; 4723; 4729; 4733; 4751; 4759; 4783; 4787; 4789; 4793; 4799; 4801; 4813; 4817; 4831; 4861; 4871; 4877; 4889; 4903; 4909; 4919; 4931; 4933; 4937; 4943; 4951; 4957; 4967; 4969; 4973; 4987; 4993; 4999; 5003; 5009; 5011; 5021; 5023; 5039; 5051; 5059; 5077; 5081; 5087; 5099; 5101; 5107; 5113; 5119; 5147; 5153; 5167; 5171; 5179; 5189; 5197; 5209; 5227; 5231; 5233; 5237; 5261; 5273; 5279; 5281; 5297; 5303; 5309; 5323; 5333; 5347; 5351; 5381; 5387; 5393; 5399; 5407; 5413; 5417; 5419; 5431; 5437; 5441; 5443; 5449; 5471; 5477; 5479; 5483; 5501; 5503; 5507; 5519; 5521; 5527; 5531; 5557; 5563; 5569; 5573; 5581; 5591; 5623; 5639; 5641; 5647; 5651; 5653; 5657; 5659; 5669; 5683; 5689; 5693; 5701; 5711; 5717; 5737; 5741; 5743; 5749; 5779; 5783; 5791; 5801; 5807; 5813; 5821; 5827; 5839; 5843; 5849; 5851; 5857; 5861; 5867; 5869; 5879; 5881; 5897; 5903; 5923; 5927; 5939; 5953; 5981; 5987; 6007; 6011; 6029; 6037; 6043; 6047; 6053; 6067; 6073; 6079; 6089; 6091; 6101; 6113; 6121; 6131; 6133; 6143; 6151; 6163; 6173; 6197; 6199; 6203; 6211; 6217; 6221; 6229; 6247; 6257; 6263; 6269; 6271; 6277; 6287; 6299; 6301; 6311; 6317; 6323; 6329; 6337; 6343; 6353; 6359; 6361; 6367; 6373; 6379; 6389; 6397; 6421; 6427; 6449; 6451; 6469; 6473; 6481; 6491; 6521; 6529; 6547; 6551; 6553; 6563; 6569; 6571; 6577; 6581; 6599; 6607; 6619; 6637; 6653; 6659; 6661; 6673; 6679; 6689; 6691; 6701; 6703; 6709; 6719; 6733; 6737; 6761; 6763; 6779; 6781; 6791; 6793; 6803; 6823; 6827; 6829; 6833; 6841; 6857; 6863; 6869; 6871; 6883; 6899; 6907; 6911; 6917; 6947; 6949; 6959; 6961; 6967; 6971; 6977; 6983; 6991; 6997; 7001; 7013; 7019; 7027; 7039; 7043; 7057; 7069; 7079; 7103; 7109; 7121; 7127; 7129; 7151; 7159; 7177; 7187; 7193; 7207; 7211; 7213; 7219; 7229; 7237; 7243; 7247; 7253; 7283; 7297; 7307; 7309; 7321; 7331; 7333; 7349; 7351; 7369; 7393; 7411; 7417; 7433; 7451; 7457; 7459; 7477; 7481; 7487; 7489; 7499; 7507; 7517; 7523; 7529; 7537; 7541; 7547; 7549; 7559; 7561; 7573; 7577; 7583; 7589; 7591; 7603; 7607; 7621; 7639; 7643; 7649; 7669; 7673; 7681; 7687; 7691; 7699; 7703; 7717; 7723; 7727; 7741; 7753; 7757; 7759; 7789; 7793; 7817; 7823; 7829; 7841; 7853; 7867; 7873; 7877; 7879; 7883; 7901; 7907; 7919; 7927; 7933; 7937; 7949; 7951; 7963; 7993; 8009; 8011; 8017; 8039; 8053; 8059; 8069; 8081; 8087; 8089; 8093; 8101; 8111; 8117; 8123; 8147; 8161; 8167; 8171; 8179; 8191; 8209; 8219; 8221; 8231; 8233; 8237; 8243; 8263; 8269; 8273; 8287; 8291; 8293; 8297; 8311; 8317; 8329; 8353; 8363; 8369; 8377; 8387; 8389; 8419; 8423; 8429; 8431; 8443; 8447; 8461; 8467; 8501; 8513; 8521; 8527; 8537; 8539; 8543; 8563; 8573; 8581; 8597; 8599; 8609; 8623; 8627; 8629; 8641; 8647; 8663; 8669; 8677; 8681; 8689; 8693; 8699; 8707; 8713; 8719; 8731; 8737; 8741; 8747; 8753; 8761; 8779; 8783; 8803; 8807; 8819; 8821; 8831; 8837; 8839; 8849; 8861; 8863; 8867; 8887; 8893; 8923; 8929; 8933; 8941; 8951; 8963; 8969; 8971; 8999; 9001; 9007; 9011; 9013; 9029; 9041; 9043; 9049; 9059; 9067; 9091; 9103; 9109; 9127; 9133; 9137; 9151; 9157; 9161; 9173; 9181; 9187; 9199; 9203; 9209; 9221; 9227; 9239; 9241; 9257; 9277; 9281; 9283; 9293; 9311; 9319; 9323; 9337; 9341; 9343; 9349; 9371; 9377; 9391; 9397; 9403; 9413; 9419; 9421; 9431; 9433; 9437; 9439; 9461; 9463; 9467; 9473; 9479; 9491; 9497; 9511; 9521; 9533; 9539; 9547; 9551; 9587; 9601; 9613; 9619; 9623; 9629; 9631; 9643; 9649; 9661; 9677; 9679; 9689; 9697; 9719; 9721; 9733; 9739; 9743; 9749; 9767; 9769; 9781; 9787; 9791; 9803; 9811; 9817; 9829; 9833; 9839; 9851; 9857; 9859; 9871; 9883; 9887; 9901; 9907; 9923; 9929; 9931; 9941; 9949; 9967; 9973 |]
let index = Map.ofArray [| 2, 0; 3, 1; 5, 2; 7, 3; 11, 4; 13, 5; 17, 6; 19, 7; 23, 8; 29, 9; 31, 10; 37, 11; 41, 12; 43, 13; 47, 14; 53, 15; 59, 16; 61, 17; 67, 18; 71, 19; 73, 20; 79, 21; 83, 22; 89, 23; 97, 24; 101, 25; 103, 26; 107, 27; 109, 28; 113, 29; 127, 30;131, 31; 137, 32; 139, 33; 149, 34; 151, 35; 157, 36; 163, 37; 167, 38; 173, 39; 179, 40; 181, 41; 191, 42; 193, 43; 197, 44; 199, 45; 211, 46; 223, 47; 227, 48; 229, 49; 233, 50; 239, 51; 241, 52; 251, 53; 257, 54; 263, 55; 269, 56; 271, 57; 277, 58; 281, 59; 283, 60; 293, 61; 307, 62; 311, 63; 313, 64; 317, 65; 331,66; 337, 67; 347, 68; 349, 69; 353, 70; 359, 71; 367, 72; 373, 73; 379, 74; 383, 75; 389, 76; 397, 77; 401, 78; 409, 79; 419, 80; 421, 81; 431, 82; 433, 83; 439, 84; 443, 85; 449, 86; 457, 87; 461, 88; 463, 89; 467, 90; 479, 91; 487, 92; 491, 93; 499, 94; 503, 95; 509, 96; 521, 97; 523, 98; 541, 99; 547, 100; 557, 101; 563, 102; 569, 103; 571, 104; 577, 105; 587, 106; 593, 107; 599, 108; 601, 109; 607, 110; 613, 111; 617, 112; 619, 113; 631, 114; 641, 115; 643, 116; 647, 117; 653, 118; 659, 119; 661, 120; 673, 121; 677, 122; 683, 123; 691, 124; 701, 125; 709, 126; 719, 127; 727, 128; 733, 129; 739, 130; 743, 131; 751, 132; 757, 133; 761, 134; 769, 135; 773, 136; 787, 137; 797, 138; 809, 139; 811, 140; 821, 141; 823, 142; 827, 143; 829, 144; 839, 145; 853, 146; 857, 147; 859, 148; 863, 149; 877, 150; 881, 151; 883, 152; 887, 153; 907, 154; 911, 155; 919, 156; 929, 157; 937, 158; 941, 159; 947, 160; 953, 161; 967, 162; 971, 163; 977, 164; 983, 165; 991, 166; 997, 167; 1009, 168; 1013, 169; 1019, 170; 1021, 171; 1031, 172; 1033, 173; 1039, 174; 1049, 175; 1051, 176; 1061, 177; 1063, 178; 1069, 179; 1087, 180; 1091, 181; 1093, 182; 1097, 183; 1103, 184; 1109, 185; 1117, 186; 1123, 187; 1129, 188; 1151, 189; 1153, 190; 1163, 191; 1171, 192; 1181, 193; 1187, 194; 1193, 195; 1201, 196; 1213, 197; 1217, 198; 1223, 199; 1229, 200; 1231, 201; 1237, 202; 1249, 203; 1259, 204; 1277, 205; 1279, 206; 1283, 207; 1289, 208; 1291, 209; 1297, 210; 1301, 211; 1303, 212; 1307, 213; 1319, 214; 1321, 215; 1327, 216;1361, 217; 1367, 218; 1373, 219; 1381, 220; 1399, 221; 1409, 222; 1423, 223; 1427, 224; 1429, 225; 1433, 226; 1439, 227; 1447, 228; 1451, 229; 1453, 230; 1459,231; 1471, 232; 1481, 233; 1483, 234; 1487, 235; 1489, 236; 1493, 237; 1499, 238; 1511, 239; 1523, 240; 1531, 241; 1543, 242; 1549, 243; 1553, 244; 1559, 245; 1567, 246; 1571, 247; 1579, 248; 1583, 249; 1597, 250; 1601, 251; 1607, 252; 1609, 253; 1613, 254; 1619, 255; 1621, 256; 1627, 257; 1637, 258; 1657, 259; 1663, 260; 1667, 261; 1669, 262; 1693, 263; 1697, 264; 1699, 265; 1709, 266; 1721, 267; 1723, 268; 1733, 269; 1741, 270; 1747, 271; 1753, 272; 1759, 273; 1777, 274; 1783, 275; 1787, 276; 1789, 277; 1801, 278; 1811, 279; 1823, 280; 1831, 281; 1847, 282; 1861, 283; 1867, 284; 1871, 285; 1873, 286; 1877, 287; 1879, 288; 1889, 289; 1901, 290; 1907, 291; 1913, 292; 1931, 293; 1933, 294; 1949, 295; 1951, 296;1973, 297; 1979, 298; 1987, 299; 1993, 300; 1997, 301; 1999, 302; 2003, 303; 2011, 304; 2017, 305; 2027, 306; 2029, 307; 2039, 308; 2053, 309; 2063, 310; 2069,311; 2081, 312; 2083, 313; 2087, 314; 2089, 315; 2099, 316; 2111, 317; 2113, 318; 2129, 319; 2131, 320; 2137, 321; 2141, 322; 2143, 323; 2153, 324; 2161, 325; 2179, 326; 2203, 327; 2207, 328; 2213, 329; 2221, 330; 2237, 331; 2239, 332; 2243, 333; 2251, 334; 2267, 335; 2269, 336; 2273, 337; 2281, 338; 2287, 339; 2293, 340; 2297, 341; 2309, 342; 2311, 343; 2333, 344; 2339, 345; 2341, 346; 2347, 347; 2351, 348; 2357, 349; 2371, 350; 2377, 351; 2381, 352; 2383, 353; 2389, 354; 2393, 355; 2399, 356; 2411, 357; 2417, 358; 2423, 359; 2437, 360; 2441, 361; 2447, 362; 2459, 363; 2467, 364; 2473, 365; 2477, 366; 2503, 367; 2521, 368; 2531, 369; 2539, 370; 2543, 371; 2549, 372; 2551, 373; 2557, 374; 2579, 375; 2591, 376;2593, 377; 2609, 378; 2617, 379; 2621, 380; 2633, 381; 2647, 382; 2657, 383; 2659, 384; 2663, 385; 2671, 386; 2677, 387; 2683, 388; 2687, 389; 2689, 390; 2693,391; 2699, 392; 2707, 393; 2711, 394; 2713, 395; 2719, 396; 2729, 397; 2731, 398; 2741, 399; 2749, 400; 2753, 401; 2767, 402; 2777, 403; 2789, 404; 2791, 405; 2797, 406; 2801, 407; 2803, 408; 2819, 409; 2833, 410; 2837, 411; 2843, 412; 2851, 413; 2857, 414; 2861, 415; 2879, 416; 2887, 417; 2897, 418; 2903, 419; 2909, 420; 2917, 421; 2927, 422; 2939, 423; 2953, 424; 2957, 425; 2963, 426; 2969, 427; 2971, 428; 2999, 429; 3001, 430; 3011, 431; 3019, 432; 3023, 433; 3037, 434; 3041, 435; 3049, 436; 3061, 437; 3067, 438; 3079, 439; 3083, 440; 3089, 441; 3109, 442; 3119, 443; 3121, 444; 3137, 445; 3163, 446; 3167, 447; 3169, 448; 3181, 449; 3187, 450; 3191, 451; 3203, 452; 3209, 453; 3217, 454; 3221, 455; 3229, 456;3251, 457; 3253, 458; 3257, 459; 3259, 460; 3271, 461; 3299, 462; 3301, 463; 3307, 464; 3313, 465; 3319, 466; 3323, 467; 3329, 468; 3331, 469; 3343, 470; 3347,471; 3359, 472; 3361, 473; 3371, 474; 3373, 475; 3389, 476; 3391, 477; 3407, 478; 3413, 479; 3433, 480; 3449, 481; 3457, 482; 3461, 483; 3463, 484; 3467, 485; 3469, 486; 3491, 487; 3499, 488; 3511, 489; 3517, 490; 3527, 491; 3529, 492; 3533, 493; 3539, 494; 3541, 495; 3547, 496; 3557, 497; 3559, 498; 3571, 499; 3581, 500; 3583, 501; 3593, 502; 3607, 503; 3613, 504; 3617, 505; 3623, 506; 3631, 507; 3637, 508; 3643, 509; 3659, 510; 3671, 511; 3673, 512; 3677, 513; 3691, 514; 3697, 515; 3701, 516; 3709, 517; 3719, 518; 3727, 519; 3733, 520; 3739, 521; 3761, 522; 3767, 523; 3769, 524; 3779, 525; 3793, 526; 3797, 527; 3803, 528; 3821, 529; 3823, 530; 3833, 531; 3847, 532; 3851, 533; 3853, 534; 3863, 535; 3877, 536;3881, 537; 3889, 538; 3907, 539; 3911, 540; 3917, 541; 3919, 542; 3923, 543; 3929, 544; 3931, 545; 3943, 546; 3947, 547; 3967, 548; 3989, 549; 4001, 550; 4003,551; 4007, 552; 4013, 553; 4019, 554; 4021, 555; 4027, 556; 4049, 557; 4051, 558; 4057, 559; 4073, 560; 4079, 561; 4091, 562; 4093, 563; 4099, 564; 4111, 565; 4127, 566; 4129, 567; 4133, 568; 4139, 569; 4153, 570; 4157, 571; 4159, 572; 4177, 573; 4201, 574; 4211, 575; 4217, 576; 4219, 577; 4229, 578; 4231, 579; 4241, 580; 4243, 581; 4253, 582; 4259, 583; 4261, 584; 4271, 585; 4273, 586; 4283, 587; 4289, 588; 4297, 589; 4327, 590; 4337, 591; 4339, 592; 4349, 593; 4357, 594; 4363, 595; 4373, 596; 4391, 597; 4397, 598; 4409, 599; 4421, 600; 4423, 601; 4441, 602; 4447, 603; 4451, 604; 4457, 605; 4463, 606; 4481, 607; 4483, 608; 4493, 609; 4507, 610; 4513, 611; 4517, 612; 4519, 613; 4523, 614; 4547, 615; 4549, 616;4561, 617; 4567, 618; 4583, 619; 4591, 620; 4597, 621; 4603, 622; 4621, 623; 4637, 624; 4639, 625; 4643, 626; 4649, 627; 4651, 628; 4657, 629; 4663, 630; 4673,631; 4679, 632; 4691, 633; 4703, 634; 4721, 635; 4723, 636; 4729, 637; 4733, 638; 4751, 639; 4759, 640; 4783, 641; 4787, 642; 4789, 643; 4793, 644; 4799, 645; 4801, 646; 4813, 647; 4817, 648; 4831, 649; 4861, 650; 4871, 651; 4877, 652; 4889, 653; 4903, 654; 4909, 655; 4919, 656; 4931, 657; 4933, 658; 4937, 659; 4943, 660; 4951, 661; 4957, 662; 4967, 663; 4969, 664; 4973, 665; 4987, 666; 4993, 667; 4999, 668; 5003, 669; 5009, 670; 5011, 671; 5021, 672; 5023, 673; 5039, 674; 5051, 675; 5059, 676; 5077, 677; 5081, 678; 5087, 679; 5099, 680; 5101, 681; 5107, 682; 5113, 683; 5119, 684; 5147, 685; 5153, 686; 5167, 687; 5171, 688; 5179, 689; 5189, 690; 5197, 691; 5209, 692; 5227, 693; 5231, 694; 5233, 695; 5237, 696;5261, 697; 5273, 698; 5279, 699; 5281, 700; 5297, 701; 5303, 702; 5309, 703; 5323, 704; 5333, 705; 5347, 706; 5351, 707; 5381, 708; 5387, 709; 5393, 710; 5399,711; 5407, 712; 5413, 713; 5417, 714; 5419, 715; 5431, 716; 5437, 717; 5441, 718; 5443, 719; 5449, 720; 5471, 721; 5477, 722; 5479, 723; 5483, 724; 5501, 725; 5503, 726; 5507, 727; 5519, 728; 5521, 729; 5527, 730; 5531, 731; 5557, 732; 5563, 733; 5569, 734; 5573, 735; 5581, 736; 5591, 737; 5623, 738; 5639, 739; 5641, 740; 5647, 741; 5651, 742; 5653, 743; 5657, 744; 5659, 745; 5669, 746; 5683, 747; 5689, 748; 5693, 749; 5701, 750; 5711, 751; 5717, 752; 5737, 753; 5741, 754; 5743, 755; 5749, 756; 5779, 757; 5783, 758; 5791, 759; 5801, 760; 5807, 761; 5813, 762; 5821, 763; 5827, 764; 5839, 765; 5843, 766; 5849, 767; 5851, 768; 5857, 769; 5861, 770; 5867, 771; 5869, 772; 5879, 773; 5881, 774; 5897, 775; 5903, 776;5923, 777; 5927, 778; 5939, 779; 5953, 780; 5981, 781; 5987, 782; 6007, 783; 6011, 784; 6029, 785; 6037, 786; 6043, 787; 6047, 788; 6053, 789; 6067, 790; 6073,791; 6079, 792; 6089, 793; 6091, 794; 6101, 795; 6113, 796; 6121, 797; 6131, 798; 6133, 799; 6143, 800; 6151, 801; 6163, 802; 6173, 803; 6197, 804; 6199, 805; 6203, 806; 6211, 807; 6217, 808; 6221, 809; 6229, 810; 6247, 811; 6257, 812; 6263, 813; 6269, 814; 6271, 815; 6277, 816; 6287, 817; 6299, 818; 6301, 819; 6311, 820; 6317, 821; 6323, 822; 6329, 823; 6337, 824; 6343, 825; 6353, 826; 6359, 827; 6361, 828; 6367, 829; 6373, 830; 6379, 831; 6389, 832; 6397, 833; 6421, 834; 6427, 835; 6449, 836; 6451, 837; 6469, 838; 6473, 839; 6481, 840; 6491, 841; 6521, 842; 6529, 843; 6547, 844; 6551, 845; 6553, 846; 6563, 847; 6569, 848; 6571, 849; 6577, 850; 6581, 851; 6599, 852; 6607, 853; 6619, 854; 6637, 855; 6653, 856;6659, 857; 6661, 858; 6673, 859; 6679, 860; 6689, 861; 6691, 862; 6701, 863; 6703, 864; 6709, 865; 6719, 866; 6733, 867; 6737, 868; 6761, 869; 6763, 870; 6779,871; 6781, 872; 6791, 873; 6793, 874; 6803, 875; 6823, 876; 6827, 877; 6829, 878; 6833, 879; 6841, 880; 6857, 881; 6863, 882; 6869, 883; 6871, 884; 6883, 885; 6899, 886; 6907, 887; 6911, 888; 6917, 889; 6947, 890; 6949, 891; 6959, 892; 6961, 893; 6967, 894; 6971, 895; 6977, 896; 6983, 897; 6991, 898; 6997, 899; 7001, 900; 7013, 901; 7019, 902; 7027, 903; 7039, 904; 7043, 905; 7057, 906; 7069, 907; 7079, 908; 7103, 909; 7109, 910; 7121, 911; 7127, 912; 7129, 913; 7151, 914; 7159, 915; 7177, 916; 7187, 917; 7193, 918; 7207, 919; 7211, 920; 7213, 921; 7219, 922; 7229, 923; 7237, 924; 7243, 925; 7247, 926; 7253, 927; 7283, 928; 7297, 929; 7307, 930; 7309, 931; 7321, 932; 7331, 933; 7333, 934; 7349, 935; 7351, 936;7369, 937; 7393, 938; 7411, 939; 7417, 940; 7433, 941; 7451, 942; 7457, 943; 7459, 944; 7477, 945; 7481, 946; 7487, 947; 7489, 948; 7499, 949; 7507, 950; 7517,951; 7523, 952; 7529, 953; 7537, 954; 7541, 955; 7547, 956; 7549, 957; 7559, 958; 7561, 959; 7573, 960; 7577, 961; 7583, 962; 7589, 963; 7591, 964; 7603, 965; 7607, 966; 7621, 967; 7639, 968; 7643, 969; 7649, 970; 7669, 971; 7673, 972; 7681, 973; 7687, 974; 7691, 975; 7699, 976; 7703, 977; 7717, 978; 7723, 979; 7727, 980; 7741, 981; 7753, 982; 7757, 983; 7759, 984; 7789, 985; 7793, 986; 7817, 987; 7823, 988; 7829, 989; 7841, 990; 7853, 991; 7867, 992; 7873, 993; 7877, 994; 7879, 995; 7883, 996; 7901, 997; 7907, 998; 7919, 999; 7927, 1000; 7933, 1001; 7937, 1002; 7949, 1003; 7951, 1004; 7963, 1005; 7993, 1006; 8009, 1007; 8011, 1008; 8017, 1009; 8039, 1010; 8053, 1011; 8059, 1012; 8069, 1013; 8081, 1014; 8087, 1015; 8089, 1016; 8093, 1017; 8101, 1018; 8111, 1019; 8117, 1020; 8123, 1021; 8147, 1022; 8161, 1023; 8167, 1024; 8171, 1025; 8179, 1026; 8191, 1027; 8209, 1028; 8219, 1029; 8221, 1030; 8231, 1031; 8233, 1032; 8237, 1033; 8243, 1034; 8263, 1035; 8269, 1036; 8273, 1037; 8287, 1038; 8291, 1039; 8293, 1040; 8297, 1041; 8311, 1042; 8317, 1043; 8329, 1044; 8353, 1045; 8363, 1046; 8369, 1047; 8377, 1048; 8387, 1049; 8389, 1050; 8419, 1051; 8423, 1052; 8429, 1053; 8431, 1054; 8443, 1055; 8447, 1056; 8461, 1057; 8467, 1058; 8501, 1059; 8513, 1060; 8521, 1061; 8527, 1062; 8537, 1063; 8539, 1064; 8543, 1065; 8563, 1066; 8573, 1067; 8581, 1068; 8597, 1069; 8599, 1070; 8609, 1071; 8623, 1072; 8627, 1073; 8629, 1074; 8641, 1075; 8647, 1076; 8663, 1077; 8669, 1078; 8677, 1079; 8681, 1080; 8689, 1081; 8693, 1082; 8699, 1083; 8707, 1084; 8713, 1085; 8719, 1086; 8731, 1087; 8737, 1088; 8741, 1089; 8747, 1090; 8753, 1091; 8761, 1092; 8779, 1093; 8783, 1094; 8803, 1095; 8807, 1096; 8819, 1097; 8821, 1098; 8831, 1099; 8837, 1100; 8839, 1101; 8849, 1102; 8861, 1103; 8863, 1104; 8867, 1105; 8887, 1106; 8893, 1107; 8923, 1108; 8929, 1109; 8933, 1110; 8941, 1111; 8951, 1112; 8963, 1113; 8969, 1114; 8971, 1115; 8999, 1116; 9001, 1117; 9007, 1118; 9011, 1119; 9013, 1120; 9029, 1121; 9041, 1122; 9043, 1123; 9049, 1124; 9059, 1125; 9067, 1126; 9091, 1127; 9103, 1128; 9109, 1129; 9127, 1130; 9133, 1131; 9137, 1132; 9151, 1133; 9157, 1134; 9161, 1135; 9173, 1136; 9181, 1137; 9187, 1138; 9199, 1139; 9203, 1140; 9209, 1141; 9221, 1142; 9227, 1143; 9239, 1144; 9241, 1145; 9257, 1146; 9277, 1147; 9281, 1148; 9283, 1149; 9293, 1150; 9311, 1151; 9319, 1152; 9323, 1153; 9337, 1154; 9341, 1155; 9343, 1156; 9349, 1157; 9371, 1158; 9377, 1159; 9391, 1160; 9397, 1161; 9403, 1162; 9413, 1163; 9419, 1164; 9421, 1165; 9431, 1166; 9433, 1167; 9437, 1168; 9439, 1169; 9461, 1170; 9463, 1171; 9467, 1172; 9473, 1173; 9479, 1174; 9491, 1175; 9497, 1176; 9511, 1177; 9521, 1178; 9533, 1179; 9539, 1180; 9547, 1181; 9551, 1182; 9587, 1183; 9601, 1184; 9613, 1185; 9619, 1186; 9623, 1187; 9629, 1188; 9631, 1189; 9643, 1190; 9649, 1191; 9661, 1192; 9677, 1193; 9679, 1194; 9689, 1195; 9697, 1196; 9719, 1197; 9721, 1198; 9733, 1199; 9739, 1200; 9743, 1201; 9749, 1202; 9767, 1203; 9769, 1204; 9781, 1205; 9787, 1206; 9791, 1207; 9803, 1208; 9811, 1209; 9817, 1210; 9829, 1211; 9833, 1212; 9839, 1213; 9851, 1214; 9857, 1215; 9859, 1216; 9871, 1217; 9883, 1218; 9887, 1219; 9901, 1220; 9907, 1221; 9923, 1222; 9929, 1223; 9931, 1224; 9941, 1225; 9949, 1226; 9967, 1227; 9973, 1228; |]
 
let min a b = if a <= b then a else b
 
let pow x n =
    let rec loop x n acc =
        match n with
        | 0 -> acc
        | _ -> loop x (n-1) (acc * x % 1000000007UL)
 
    loop x n 1UL
 
let rec compute factor n power =
    if n % factor = 0 then
        compute factor (n/factor) (power+1)
    else
        (power, n)
 
let rec travel num idx acc =
    if num = 1 || primes.[idx] > num then (List.rev acc) |> List.toArray
    elif num % primes.[idx] = 0 then
        let power, quotient = compute primes.[idx] num 0
        travel quotient (idx+1) ( (primes.[idx], power) :: acc )
    else
        travel num (idx+1) acc
 
[<EntryPoint>]
let main argv = 
    let n = Console.In.ReadLine() |> int
    let aList = Console.In.ReadLine().Split(' ') |> Array.map int
    let m = Console.In.ReadLine() |> int
    let bList = Console.In.ReadLine().Split(' ') |> Array.map int
 
    let a : int array = Array.zeroCreate primes.Length
    let b : int array = Array.zeroCreate primes.Length
 
 
    for i in 0..n-1 do
        if aList.[i] <> 1 then
            let result = travel aList.[i] 0 []
    
            for j in 0..result.Length-1 do
                let p = fst result.[j]
                let idx = index.TryFind(p).Value
                a.[idx] <- a.[idx] + (snd result.[j])
 
    for i in 0..m-1 do
        if bList.[i] <> 1 then
            let result = travel bList.[i] 0 []
    
            for j in 0..result.Length-1 do
                let p = fst result.[j]
                let idx = index.TryFind(p).Value
                b.[idx] <- b.[idx] + (snd result.[j])
 
    let mutable ret : uint64 = 1UL
 
    for i in 0..primes.Length-1 do
        if (a.[i] > 0) && (b.[i] > 0) then
            ret <- ret * (pow (uint64 primes.[i]) (min a.[i] b.[i])) % 1000000007UL
 
    printfn "%d" ret
    
    0
